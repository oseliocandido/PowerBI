
<!-- saved from url=(0105)file:///G:/Meu%20Drive/Dados/Trabalho/Carreira/Portf%C3%B3lio/GitHub/Reports/KPI%20Panel/M%20Queries.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>body {
      color: #000000;
      background-color: #FFFFFF;
      font-size: 24;
      font-family: Serif;
      font-weight: bold;
      font-style: italic;
      }
      h1, h2, h3, h4, h5, h6 {
      color: #000000;
      background-color: #FFFFFF;
      font-size: 24;
      font-family: Serif;
      font-weight: bold;
      font-style: italic;
      }
      table, pre {
      color: #000000;
      background-color: #FFFFFF;
      font-size: 16;
      font-family: Serif;
      font-weight: normal;
      font-style: normal;
      }
      ul, #myUL {
      list-style-type: none;
      }
      #myUL {
      margin: 0;
      padding: 0;
      }
      .caret, .dropDownCaret {
      cursor: pointer;
      }
      .caret::before {
      content: "\25B6";
      color: black;
      display: inline - block;
      margin - right: 6px;
      }
      .dropDownCaret::before {
      content: "\25BC";
      color: black;
      display: inline - block;
      margin - right: 6px;
      float: right;
      }
      .nested {
      display: none;
      }
      .active {
      display: block;
      }
   </style>
   </head>
   <body>
      <div>Power BI Documentation</div>
      <div>
      Generated by <a href="http://radacad.com/power-bi-helper">Power BI Helper</a> (Copyright © <a href="http://radacad.com/">RADACAD</a>).<br><br>Key Performance Indicators<hr>
      </div><br>M Queries
      <br>
      <table border="1px" cellpadding="1" cellspacing="1"><tbody><tr><td>Name</td><td>QueryDefinition</td></tr><tr><td>fact Target-efe65bd2-f50f-4be4-87ba-311ba10c6396</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"SharePoint Acess"</font>,<br>    <br>    #<font color="red">"Filtered Rows"</font> = <font color="purple">Table.SelectRows</font>(Source, each <font color="purple">Text.Start</font>sWith([Name], <font color="red">"New Database KPI"</font>) and [Extension] = <font color="red">".xlsx"</font>),<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Filtered Rows"</font>,{<font color="red">"Content"</font>, <font color="red">"Name"</font>}),<br><br>    #<font color="red">"Open Excel"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Removed Other Columns"</font>, <font color="red">"Contents"</font>, each <font color="purple">Excel.Workbook</font>([Content])),<br><br>    #<font color="red">"Expanded Contents"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Open Excel"</font>, <font color="red">"Contents"</font>, {<font color="red">"Data"</font>, <font color="red">"Item"</font>, <font color="red">"Kind"</font>}, {<font color="red">"Data"</font>, <font color="red">"Item"</font>, <font color="red">"Kind"</font>}),<br><br>    #<font color="red">"Extracted Text Between Delimiters"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Expanded Contents"</font>, {{<font color="red">"Name"</font>, each <font color="purple">Text.BetweenDelimiters</font>(_, "(<font color="red">", "</font>)"), <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Split Column by Delimiter"</font> = <font color="purple">Table.Split</font>Column(#<font color="red">"Extracted Text Between Delimiters"</font>, <font color="red">"Name"</font>, <font color="purple">Splitter.SplitTextByDelimiter</font>("-", <font color="purple">QuoteStyle.Csv</font>), {<font color="red">"Name.1.1"</font>, <font color="red">"Name.2"</font>}),<br><br>    #<font color="red">"Filtered Rows1"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Split Column by Delimiter"</font>, each ([Kind] = <font color="red">"Table"</font>) and ([Item] = <font color="red">"Target"</font>)),<br><br>    #<font color="red">"Removed Other Columns1"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Filtered Rows1"</font>,{<font color="red">"Name.2"</font>, <font color="red">"Data"</font>}),<br><br>    #<font color="red">"Expanded Data"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Removed Other Columns1"</font>, <font color="red">"Data"</font>, {<font color="red">"Target"</font>, <font color="red">"JAN"</font>, <font color="red">"FEB"</font>, <font color="red">"MAR"</font>, <font color="red">"APR"</font>, <font color="red">"MAY"</font>, <font color="red">"JUN"</font>, <font color="red">"JUL"</font>, <font color="red">"AUG"</font>, <font color="red">"SEP"</font>, <font color="red">"OCT"</font>, <font color="red">"NOV"</font>, <font color="red">"DEC"</font>}, {<font color="red">"Target"</font>, <font color="red">"JAN"</font>, <font color="red">"FEB"</font>, <font color="red">"MAR"</font>, <font color="red">"APR"</font>, <font color="red">"MAY"</font>, <font color="red">"JUN"</font>, <font color="red">"JUL"</font>, <font color="red">"AUG"</font>, <font color="red">"SEP"</font>, <font color="red">"OCT"</font>, <font color="red">"NOV"</font>, <font color="red">"DEC"</font>}),<br><br>    #<font color="red">"Unpivoted Other Columns"</font> = <font color="purple">Table.Unpivot</font>OtherColumns(#<font color="red">"Expanded Data"</font>, {<font color="red">"Name.2"</font>, <font color="red">"Target"</font>}, <font color="red">"Attribute"</font>, <font color="red">"Value"</font>),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Unpivoted Other Columns"</font>,{{<font color="red">"Target"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Value"</font>, <font color="blue">type</font> number}, {<font color="red">"Name.2"</font>, <font color="purple">Int64.Type</font>}}),<br><br>    #<font color="red">"Trimmed Text"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Changed Type"</font>,{{<font color="red">"Target"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Attribute"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Capitalized Each Word"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Trimmed Text"</font>,{{<font color="red">"Target"</font>, <font color="purple">Text.Proper</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Attribute"</font>, <font color="purple">Text.Proper</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Merged Queries"</font> = <font color="purple">Table.NestedJoin</font>(#<font color="red">"Capitalized Each Word"</font>, {<font color="red">"Attribute"</font>, <font color="red">"Name.2"</font>}, #<font color="red">"Months Abrev Lookup"</font>, {<font color="red">"Abrev"</font>, <font color="red">"Year"</font>}, <font color="red">"Months Abrev Lookup"</font>, <font color="purple">JoinKind.LeftOuter</font>),<br><br>    #<font color="red">"Expanded Months Abrev Lookup"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Merged Queries"</font>, <font color="red">"Months Abrev Lookup"</font>, {<font color="red">"Complete Date"</font>}, {<font color="red">"Complete Date"</font>}),<br><br>    #<font color="red">"Merged Queries1"</font> = <font color="purple">Table.NestedJoin</font>(#<font color="red">"Expanded Months Abrev Lookup"</font>, {<font color="red">"Target"</font>}, #<font color="red">"dim KPI"</font>, {<font color="red">"KPI"</font>}, "dim KPI's", <font color="purple">JoinKind.Inner</font>),<br><br>    #<font color="red">"Removed Other Columns2"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Merged Queries1"</font>,{<font color="red">"Name.2"</font>, <font color="red">"Target"</font>, <font color="red">"Value"</font>, <font color="red">"Complete Date"</font>}),<br><br>    #<font color="red">"Renamed Columns"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Removed Other Columns2"</font>,{{<font color="red">"Name.2"</font>, <font color="red">"Year"</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Renamed Columns"</font></td></tr><tr><td>dim KPI-083aeb4d-a7ac-41c2-a591-b1a485203a03</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"SharePoint Acess"</font>,<br><br>    #"New Database KPI (2021-2022) xlsx" = Source{[Name=<font color="red">"KPI Registration.xlsx"</font>]}[Content],<br><br>    #<font color="red">"Imported Excel Workbook"</font> = <font color="purple">Excel.Workbook</font>(#"New Database KPI (2021-2022) xlsx"),<br><br>    Target_Info_Table = #<font color="red">"Imported Excel Workbook"</font>{[Item=<font color="red">"Information"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(Target_Info_Table,{<font color="red">"Direction"</font>, <font color="red">"KPI"</font>, <font color="red">"Father KPI"</font>, <font color="red">"Type"</font>, <font color="red">"BSC Perspective"</font>, <font color="red">"Related Area"</font>, <font color="red">"Source"</font>, <font color="red">"Definition"</font>, <font color="red">"Status"</font>, "Threshold (Green)<font color="red">", "</font>Threshold (Yellow)"}),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Removed Other Columns"</font>,{{<font color="red">"KPI"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Direction"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Related Area"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Definition"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Type"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Status"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"BSC Perspective"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {"Threshold (Green)", <font color="purple">Percentage.Type</font>}, {"Threshold (Yellow)", <font color="purple">Percentage.Type</font>}, {<font color="red">"Father KPI"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Trimmed Text"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Changed Type"</font>,{{<font color="red">"KPI"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Direction"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Type"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"BSC Perspective"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Related Area"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Status"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Father KPI"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Capitalized Each Word"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Trimmed Text"</font>,{{<font color="red">"KPI"</font>, <font color="purple">Text.Proper</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Father KPI"</font>, <font color="purple">Text.Proper</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Added Conditional Column"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Capitalized Each Word"</font>, <font color="red">"Short Perspective"</font>, each if [BSC Perspective] = <font color="red">"Internal Process"</font> then <font color="red">"Internal"</font> else if [BSC Perspective] = "Learning &amp; Growth<font color="red">" then "</font>Learning" else [BSC Perspective],<font color="blue">type</font> <font color="blue">text</font>)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Added Conditional Column"</font></td></tr><tr><td>fact Actuals-c45c4751-3972-4ff2-a3d4-40b968afc24b</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"SharePoint Acess"</font>,<br>    <br>    #<font color="red">"Filtered Rows"</font> = <font color="purple">Table.SelectRows</font>(Source, each <font color="purple">Text.Start</font>sWith([Name], <font color="red">"New Database KPI"</font>) and [Extension] = <font color="red">".xlsx"</font>),<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Filtered Rows"</font>,{<font color="red">"Content"</font>, <font color="red">"Name"</font>}),<br><br>    #<font color="red">"Open Excel"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Removed Other Columns"</font>, <font color="red">"Contents"</font>, each <font color="purple">Excel.Workbook</font>([Content])),<br><br>    #<font color="red">"Expanded Contents"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Open Excel"</font>, <font color="red">"Contents"</font>, {<font color="red">"Data"</font>, <font color="red">"Item"</font>, <font color="red">"Kind"</font>}, {<font color="red">"Data"</font>, <font color="red">"Item"</font>, <font color="red">"Kind"</font>}),<br><br>    #<font color="red">"Extracted Text Between Delimiters"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Expanded Contents"</font>, {{<font color="red">"Name"</font>, each <font color="purple">Text.BetweenDelimiters</font>(_, "(<font color="red">", "</font>)"), <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Split Column by Delimiter"</font> = <font color="purple">Table.Split</font>Column(#<font color="red">"Extracted Text Between Delimiters"</font>, <font color="red">"Name"</font>, <font color="purple">Splitter.SplitTextByDelimiter</font>("-", <font color="purple">QuoteStyle.Csv</font>), {<font color="red">"Name.1.1"</font>, <font color="red">"Name.2"</font>}),<br><br>    #<font color="red">"Filtered Rows1"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Split Column by Delimiter"</font>, each ([Kind] = <font color="red">"Table"</font>) and ([Item] = <font color="red">"Actuals"</font>)),<br><br>    #<font color="red">"Removed Other Columns1"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Filtered Rows1"</font>,{<font color="red">"Name.2"</font>, <font color="red">"Data"</font>}),<br><br>    #<font color="red">"Expanded Data"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Removed Other Columns1"</font>, <font color="red">"Data"</font>, {<font color="red">"Current Results"</font>, <font color="red">"JAN"</font>, <font color="red">"FEB"</font>, <font color="red">"MAR"</font>, <font color="red">"APR"</font>, <font color="red">"MAY"</font>, <font color="red">"JUN"</font>, <font color="red">"JUL"</font>, <font color="red">"AUG"</font>, <font color="red">"SEP"</font>, <font color="red">"OCT"</font>, <font color="red">"NOV"</font>, <font color="red">"DEC"</font>}, {<font color="red">"Current Results"</font>, <font color="red">"JAN"</font>, <font color="red">"FEB"</font>, <font color="red">"MAR"</font>, <font color="red">"APR"</font>, <font color="red">"MAY"</font>, <font color="red">"JUN"</font>, <font color="red">"JUL"</font>, <font color="red">"AUG"</font>, <font color="red">"SEP"</font>, <font color="red">"OCT"</font>, <font color="red">"NOV"</font>, <font color="red">"DEC"</font>}),<br><br>    #<font color="red">"Unpivoted Other Columns"</font> = <font color="purple">Table.Unpivot</font>OtherColumns(#<font color="red">"Expanded Data"</font>, {<font color="red">"Name.2"</font>, <font color="red">"Current Results"</font>}, <font color="red">"Attribute"</font>, <font color="red">"Value"</font>),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Unpivoted Other Columns"</font>,{{<font color="red">"Current Results"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Value"</font>, <font color="blue">type</font> number}, {<font color="red">"Name.2"</font>, <font color="purple">Int64.Type</font>}}),<br><br>    #<font color="red">"Trimmed Text"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Changed Type"</font>,{{<font color="red">"Current Results"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Attribute"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Capitalized Each Word"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Trimmed Text"</font>,{{<font color="red">"Current Results"</font>, <font color="purple">Text.Proper</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Attribute"</font>, <font color="purple">Text.Proper</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Merged Queries"</font> = <font color="purple">Table.NestedJoin</font>(#<font color="red">"Capitalized Each Word"</font>, {<font color="red">"Name.2"</font>, <font color="red">"Attribute"</font>}, #<font color="red">"Months Abrev Lookup"</font>, {<font color="red">"Year"</font>, <font color="red">"Abrev"</font>}, <font color="red">"Months Abrev Lookup"</font>, <font color="purple">JoinKind.LeftOuter</font>),<br><br>    #<font color="red">"Expanded Months Abrev Lookup"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Merged Queries"</font>, <font color="red">"Months Abrev Lookup"</font>, {<font color="red">"Complete Date"</font>}, {<font color="red">"Complete Date"</font>}),<br><br>    #<font color="red">"Merged Queries1"</font> = <font color="purple">Table.NestedJoin</font>(#<font color="red">"Expanded Months Abrev Lookup"</font>, {<font color="red">"Current Results"</font>}, #<font color="red">"dim KPI"</font>, {<font color="red">"KPI"</font>}, "dim KPI's", <font color="purple">JoinKind.Inner</font>),<br><br>    #<font color="red">"Removed Other Columns2"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Merged Queries1"</font>,{<font color="red">"Name.2"</font>, <font color="red">"Current Results"</font>, <font color="red">"Value"</font>, <font color="red">"Complete Date"</font>}),<br><br>    #<font color="red">"Renamed Columns"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Removed Other Columns2"</font>,{{<font color="red">"Name.2"</font>, <font color="red">"Year"</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Renamed Columns"</font></td></tr><tr><td>dim Calendar-4fb80c71-ed5e-4d55-ab36-e7209e91b22d</td><td><font color="blue">let</font><br><br>    Datas = <font color="purple">Table.FromList</font>({<font color="purple">Number.From</font>(#<font color="blue">date</font>(2022,01,01))..<font color="purple">Number.From</font>(<font color="purple">Date.EndOfYear</font>(<font color="purple">Date.From</font>(<font color="purple">DateTime.LocalNow</font>())))}, <font color="purple">Splitter.SplitByNothing</font>(), {<font color="red">"Calendario"</font>}, <font color="blue">null</font>, <font color="purple">ExtraValues.Error</font>),<br><br>    #<font color="red">"To_Date"</font> = <font color="purple">Table.TransformColumnTypes</font>(Datas,{{<font color="red">"Calendario"</font>, <font color="blue">type</font> <font color="blue">date</font>}}),<br><br>    #<font color="red">"Ano Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"To_Date"</font>, <font color="red">"Year"</font>, each <font color="purple">Date.Year</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Mês Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Ano Inserido"</font>, <font color="red">"Numero do Mês"</font>, each <font color="purple">Date.Month</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Dia Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Mês Inserido"</font>, <font color="red">"Dia"</font>, each <font color="purple">Date.Day</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Numero do Trimestre"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Dia Inserido"</font>, <font color="red">"Numero do Trimestre"</font>, each <font color="purple">Date.QuarterOfYear</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Nome do Trimestre"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Numero do Trimestre"</font>, <font color="red">"Quarter"</font>, each <font color="red">"Q"</font> &amp; <font color="purple">Text.From</font>([Numero do Trimestre], "pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Numero da Semana do Ano"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome do Trimestre"</font>, <font color="red">"Numero Semana do Ano"</font>, each <font color="purple">Date.WeekOfYear</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Nome da Semana do Ano"</font> = <font color="purple">Table.AddColumn</font>( #<font color="red">"Numero da Semana do Ano"</font>, <font color="red">"Semana do Ano"</font>, each <font color="red">"Sem "</font> &amp; <font color="purple">Text.From</font>([Numero Semana do Ano], "pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Nome do Mês"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome da Semana do Ano"</font>, <font color="red">"Mês"</font>, each <font color="purple">Date.Month</font>Name([Calendario],"en-US"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #"Mes-Ano Abrevs"= <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome do Mês"</font>, <font color="red">"MêsAno Abrev"</font>, each <font color="purple">Text.Combine</font>({<font color="purple">Text.Start</font>([Mês], 3), <font color="red">"/"</font>, <font color="purple">Text.End</font>(<font color="purple">Text.From</font>([Year], "pt-BR"),2)}),<font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Nome do Dia da Semana"</font> = <font color="purple">Table.AddColumn</font>(#"Mes-Ano Abrevs<font color="red">", "</font>Dia da Semana", each <font color="purple">Date.Day</font>OfWeekName([Calendario],"pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Semana do Mês"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome do Dia da Semana"</font>, <font color="red">"Numero Semana do Mês"</font>, each <font color="purple">Date.WeekOfMonth</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Nome da Semana do Mês"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Semana do Mês"</font>, <font color="red">"Semana do Mês"</font>, each <font color="red">"Sem "</font> &amp; <font color="purple">Text.From</font>([Numero Semana do Mês], "pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Mês_Ano_Abrev"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome da Semana do Mês"</font>, <font color="red">"MêsAno Completo"</font>, each <font color="purple">Text.Combine</font>({<font color="purple">Text.Start</font>([Mês], 3), <font color="red">"/"</font>, <font color="purple">Text.From</font>([Year], "pt-BR")}), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Dia da Semana"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Mês_Ano_Abrev"</font>, <font color="red">"Numero Dia da Semana"</font>, each <font color="purple">Date.Day</font>OfWeek([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Dia Util"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Dia da Semana"</font>, <font color="red">"Dia Util"</font>, each if <font color="purple">List.Contains</font>Any({[Numero Dia da Semana]},{0,6}) then 0 else 1,<font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Ano Mes Sort Order"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Dia Util"</font> , <font color="red">"AnoMes"</font>, each [Year] * 100 + [Numero do Mês], <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Ano Mes Dia Sort Order"</font> = <font color="purple">Table.AddColumn</font>( #<font color="red">"Ano Mes Sort Order"</font>, <font color="red">"DateSerial"</font>, each [Year] * 10000 + [Numero do Mês] * 100 + [Dia], <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Mes Abrev"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Ano Mes Dia Sort Order"</font>, <font color="red">"Month"</font>, each <font color="purple">Text.Start</font>([Mês], 3), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Datas Passadas"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Mes Abrev"</font>, "Passado?", each if [Calendario] &lt;= <font color="purple">Date.From</font>(<font color="purple">DateTime.LocalNow</font>()) then 1 else 0, <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Mes Atual"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Datas Passadas"</font>, <font color="red">"Mês Ano Atual"</font>, each if [Numero do Mês] = <font color="purple">Date.Month</font>(<font color="purple">DateTime.LocalNow</font>()) and [Year] = <font color="purple">Date.Year</font>(<font color="purple">DateTime.LocalNow</font>()) then 1 else 0, <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Selected Title Quarter"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Mes Atual"</font>, <font color="red">"Selected Quarter Title"</font>, each <font color="purple">Text.From</font>([Numero do Trimestre]) &amp; <font color="red">"º Quarter"</font>,<font color="blue">type</font> <font color="blue">text</font>)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Selected Title Quarter"</font></td></tr><tr><td>Medidas-1b9763d6-d183-49f5-ac1a-62e8a6186192</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text(<font color="red">"i45WMlKKjQUA"</font>, <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [a = _t]),<br><br>    #<font color="red">"Removed Columns"</font> = <font color="purple">Table.RemoveColumns</font>(Source,{<font color="red">"a"</font>})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Removed Columns"</font></td></tr><tr><td>Aux FIlter Status KPI Qt-db3cdafa-1f27-4011-b81f-b4a64cceb397</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i45Wci7KLMlMTsxR0lHSNQQSxkqxOtFK4YlFeZl56UC+ARAbgcXc8/NTgBxDMI6NBQA=", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Status KPI"</font> = _t, Value = _t, #<font color="red">"Sort Order"</font> = _t]),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(Source,{{<font color="red">"Value"</font>, <font color="purple">Int64.Type</font>}, {<font color="red">"Sort Order"</font>, <font color="purple">Int64.Type</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Changed Type"</font></td></tr><tr><td>Periods-8d1b4255-df27-4930-affc-d7f16bc80451</td><td>{<br><br>    (<font color="red">"Quarters"</font>, NAMEOF('dim Calendar'[Quarter]), 0),<br><br>    (<font color="red">"Months"</font>, NAMEOF('dim Calendar'[Month]), 1)<br><br>}</td></tr><tr><td>Update Time-b832f8cf-673a-449c-a1bb-cac55f94dbd8</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">DateTimeZone.SwitchZone</font>( <font color="purple">DateTimeZone.UtcNow</font>(), -3,0),<br><br>    #<font color="red">"Converted to Table"</font> = #table(1, {{Source}}),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Converted to Table"</font>,{{<font color="red">"Column1"</font>, <font color="blue">type</font> datetime}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Changed Type"</font></td></tr><tr><td>Aux Missing Values-0ab5d027-e7f6-4729-a7f4-1ede741d6cb2</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i45WckwuKU3MKVaK1YlWCkksSk8tATMDIpViYwE=", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [Missing = _t])<br><br><font color="blue">in</font><br><br>    Source</td></tr><tr><td>fact PY-5df31c98-ab47-4263-bdb5-8644d9414f52</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"SharePoint Acess"</font>,<br>    <br>    #<font color="red">"Filtered Rows"</font> = <font color="purple">Table.SelectRows</font>(Source, each <font color="purple">Text.Start</font>sWith([Name], <font color="red">"New Database KPI"</font>) and [Extension] = <font color="red">".xlsx"</font>),<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Filtered Rows"</font>,{<font color="red">"Content"</font>, <font color="red">"Name"</font>}),<br><br>    #<font color="red">"Open Excel"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Removed Other Columns"</font>, <font color="red">"Contents"</font>, each <font color="purple">Excel.Workbook</font>([Content])),<br><br>    #<font color="red">"Expanded Contents"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Open Excel"</font>, <font color="red">"Contents"</font>, {<font color="red">"Data"</font>, <font color="red">"Item"</font>, <font color="red">"Kind"</font>}, {<font color="red">"Data"</font>, <font color="red">"Item"</font>, <font color="red">"Kind"</font>}),<br><br>    #<font color="red">"Extracted Text Between Delimiters"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Expanded Contents"</font>, {{<font color="red">"Name"</font>, each <font color="purple">Text.BetweenDelimiters</font>(_, "(<font color="red">", "</font>)"), <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Split Column by Delimiter"</font> = <font color="purple">Table.Split</font>Column(#<font color="red">"Extracted Text Between Delimiters"</font>, <font color="red">"Name"</font>, <font color="purple">Splitter.SplitTextByDelimiter</font>("-", <font color="purple">QuoteStyle.Csv</font>), {<font color="red">"Name.1.1"</font>, <font color="red">"Name.2"</font>}),<br><br>    #<font color="red">"Filtered Rows1"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Split Column by Delimiter"</font>, each ([Kind] = <font color="red">"Table"</font>) and ([Item] = <font color="red">"PY"</font>)),<br><br>    #<font color="red">"Removed Other Columns1"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Filtered Rows1"</font>,{<font color="red">"Name.2"</font>, <font color="red">"Data"</font>}),<br><br>    #<font color="red">"Expanded Data"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Removed Other Columns1"</font>, <font color="red">"Data"</font>, {<font color="red">"Current Results"</font>, <font color="red">"JAN"</font>, <font color="red">"FEB"</font>, <font color="red">"MAR"</font>, <font color="red">"APR"</font>, <font color="red">"MAY"</font>, <font color="red">"JUN"</font>, <font color="red">"JUL"</font>, <font color="red">"AUG"</font>, <font color="red">"SEP"</font>, <font color="red">"OCT"</font>, <font color="red">"NOV"</font>, <font color="red">"DEC"</font>}, {<font color="red">"Current Results"</font>, <font color="red">"JAN"</font>, <font color="red">"FEB"</font>, <font color="red">"MAR"</font>, <font color="red">"APR"</font>, <font color="red">"MAY"</font>, <font color="red">"JUN"</font>, <font color="red">"JUL"</font>, <font color="red">"AUG"</font>, <font color="red">"SEP"</font>, <font color="red">"OCT"</font>, <font color="red">"NOV"</font>, <font color="red">"DEC"</font>}),<br><br>    #<font color="red">"Unpivoted Other Columns"</font> = <font color="purple">Table.Unpivot</font>OtherColumns(#<font color="red">"Expanded Data"</font>, {<font color="red">"Name.2"</font>, <font color="red">"Current Results"</font>}, <font color="red">"Attribute"</font>, <font color="red">"Value"</font>),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Unpivoted Other Columns"</font>,{{<font color="red">"Current Results"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Value"</font>, <font color="blue">type</font> number}, {<font color="red">"Name.2"</font>, <font color="purple">Int64.Type</font>}}),<br><br>    #<font color="red">"Trimmed Text"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Changed Type"</font>,{{<font color="red">"Current Results"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Attribute"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Capitalized Each Word"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Trimmed Text"</font>,{{<font color="red">"Current Results"</font>, <font color="purple">Text.Proper</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Attribute"</font>, <font color="purple">Text.Proper</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Merged Queries"</font> = <font color="purple">Table.NestedJoin</font>(#<font color="red">"Capitalized Each Word"</font>, {<font color="red">"Attribute"</font>, <font color="red">"Name.2"</font>}, #<font color="red">"Months Abrev Lookup"</font>, {<font color="red">"Abrev"</font>, <font color="red">"Year"</font>}, <font color="red">"Months Abrev Lookup"</font>, <font color="purple">JoinKind.LeftOuter</font>),<br><br>    #<font color="red">"Expanded Months Abrev Lookup"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Merged Queries"</font>, <font color="red">"Months Abrev Lookup"</font>, {<font color="red">"Complete Date"</font>}, {<font color="red">"Complete Date"</font>}),<br><br>    #<font color="red">"Merged Queries1"</font> = <font color="purple">Table.NestedJoin</font>(#<font color="red">"Expanded Months Abrev Lookup"</font>, {<font color="red">"Current Results"</font>}, #<font color="red">"dim KPI"</font>, {<font color="red">"KPI"</font>}, "dim KPI's", <font color="purple">JoinKind.Inner</font>),<br><br>    #<font color="red">"Removed Other Columns2"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Merged Queries1"</font>,{<font color="red">"Name.2"</font>, <font color="red">"Current Results"</font>, <font color="red">"Value"</font>, <font color="red">"Complete Date"</font>}),<br><br>    #<font color="red">"Renamed Columns"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Removed Other Columns2"</font>,{{<font color="red">"Name.2"</font>, <font color="red">"Year"</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Renamed Columns"</font></td></tr><tr><td>Year Filter Propagation Wokrbooks-3421f3c4-2896-48a6-b991-9b0407c789e4</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i45WMjIwMlKK1QEzjGEMExjDFMYwgzHMlWJjAQ==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Year Filter"</font> = _t]),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(Source,{{<font color="red">"Year Filter"</font>, <font color="purple">Int64.Type</font>}}),<br><br>    #<font color="red">"Added Custom"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Changed Type"</font>, "Ano Corrente / Passado?", each if [Year Filter] &lt;= <font color="purple">Date.Year</font>(<font color="purple">DateTime.LocalNow</font>()) then 1 else  0,<font color="purple">Int64.Type</font>)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Added Custom"</font></td></tr></tbody></table>
</body></html>