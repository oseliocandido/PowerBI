
<!-- saved from url=(0129)file:///G:/Meu%20Drive/Dados/Trabalho/Carreira/Portf%C3%B3lio/GitHub/Reports/Eletricity%20Production%20Scenarios/M%20Queries.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>body {
   color: #000000;
   background-color: #FFFFFF;
   font-size: 24;
   font-family: Serif;
   font-weight: bold;
   font-style: italic;
   }
   h1, h2, h3, h4, h5, h6 {
   color: #000000;
   background-color: #FFFFFF;
   font-size: 24;
   font-family: Serif;
   font-weight: bold;
   font-style: italic;
   }
   table, pre {
   color: #000000;
   background-color: #FFFFFF;
   font-size: 16;
   font-family: Serif;
   font-weight: normal;
   font-style: normal;
   }
   ul, #myUL {
   list-style-type: none;
   }
   #myUL {
   margin: 0;
   padding: 0;
   }
   .caret, .dropDownCaret {
   cursor: pointer;
   }
   .caret::before {
   content: "\25B6";
   color: black;
   display: inline - block;
   margin - right: 6px;
   }
   .dropDownCaret::before {
   content: "\25BC";
   color: black;
   display: inline - block;
   margin - right: 6px;
   float: right;
   }
   .nested {
   display: none;
   }
   .active {
   display: block;
   }
</style>
</head><body>
   <div>Power BI Documentation</div>
   <div>
   Generated by <a href="http://radacad.com/power-bi-helper">Power BI Helper</a> (Copyright © <a href="http://radacad.com/">RADACAD</a>).<br><br>Eletricity Production Scenarios<hr> <br>
   </div>M Queries<br>
      <table border="1px" cellpadding="1" cellspacing="1"><tbody><tr><td>Name</td><td>QueryDefinition</td></tr><tr><td>dim Calendar-b7ed55be-0af4-492f-8adf-60fdba5fd7f5</td><td><font color="blue">let</font><br><br>    Datas = <font color="purple">Table.FromList</font>({<font color="purple">Number.From</font>(#<font color="blue">date</font>(2008,01,01))..<font color="purple">Number.From</font>(<font color="purple">Date.AddYears</font>(<font color="purple">Date.EndOfYear</font>(<font color="purple">Date.From</font>(<font color="purple">DateTime.LocalNow</font>())),20))+1}, <font color="purple">Splitter.SplitByNothing</font>(), <font color="blue">null</font>, <font color="blue">null</font>, <font color="purple">ExtraValues.Error</font>),<br><br>    #<font color="red">"Renamed Columns"</font> = <font color="purple">Table.RenameColumns</font>(Datas,{{<font color="red">"Column1"</font>, <font color="red">"Calendario"</font>}}),<br><br>    #<font color="red">"To_Date"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Renamed Columns"</font>,{{<font color="red">"Calendario"</font>, <font color="blue">type</font> <font color="blue">date</font>}}),<br><br>    #<font color="red">"Ano Inserido"</font> = <font color="purple">Table.AddColumn</font>(To_Date, <font color="red">"Year"</font>, each <font color="purple">Date.Year</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Mês Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Ano Inserido"</font>, <font color="red">"Mês"</font>, each <font color="purple">Date.Month</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Dia Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Mês Inserido"</font>, <font color="red">"Dia do Mês"</font>, each <font color="purple">Date.Day</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Numero do Trimestre"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Dia Inserido"</font>, <font color="red">"Trimestre"</font>, each <font color="purple">Date.QuarterOfYear</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Nome do Trimestre"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Numero do Trimestre"</font>, <font color="red">"Nome do Trimestre"</font>, each <font color="red">"Trim "</font> &amp; <font color="purple">Text.From</font>([Trimestre], "pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Numero da Semana do Ano"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome do Trimestre"</font>, <font color="red">"Semana do Ano"</font>, each <font color="purple">Date.WeekOfYear</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Nome da Semana do Ano"</font> = <font color="purple">Table.AddColumn</font>( #<font color="red">"Numero da Semana do Ano"</font>, <font color="red">"Nome da Semana do Ano"</font>, each <font color="red">"Sem "</font> &amp; <font color="purple">Text.From</font>([Semana do Ano], "pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Nome do Mês"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome da Semana do Ano"</font>, <font color="red">"Nome do Mês"</font>, each <font color="purple">Date.Month</font>Name([Calendario],"en-US"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #"Mes-Ano Abrevs"= <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome do Mês"</font>, <font color="red">"Mês Ano Abrevs."</font>, each <font color="purple">Text.Combine</font>({<font color="purple">Text.Start</font>([Nome do Mês], 3), <font color="red">"/"</font>, <font color="purple">Text.End</font>(<font color="purple">Text.From</font>([Year], "pt-BR"),2)}),<font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Nome do Dia da Semana"</font> = <font color="purple">Table.AddColumn</font>(#"Mes-Ano Abrevs<font color="red">", "</font>Nome do Dia da Semana", each <font color="purple">Date.Day</font>OfWeekName([Calendario]), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Semana do Mês"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome do Dia da Semana"</font>, <font color="red">"Semana do Mês"</font>, each <font color="purple">Date.WeekOfMonth</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Nome da Semana do Mês"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Semana do Mês"</font>, <font color="red">"Nome da Semana do Mês"</font>, each <font color="red">"Sem "</font> &amp; <font color="purple">Text.From</font>([Semana do Mês], "pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Mês_Ano_Abrev"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome da Semana do Mês"</font>, <font color="red">"Mês Ano Abrev."</font>, each <font color="purple">Text.Combine</font>({<font color="purple">Text.Start</font>([Nome do Mês], 3), <font color="red">"/"</font>, <font color="purple">Text.From</font>([Year], "pt-BR")}), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Dia da Semana"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Mês_Ano_Abrev"</font>, <font color="red">"Dia da Semana"</font>, each <font color="purple">Date.Day</font>OfWeek([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Dia Util"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Dia da Semana"</font>, <font color="red">"Dia Util"</font>, each if [Dia da Semana] = 0 then 0 else if [Dia da Semana] = 6 then 0 else 1,<font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Ano Mes Sort Order"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Dia Util"</font> , <font color="red">"AnoMes"</font>, each [Year] * 100 + [Mês], <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Ano Mes Dia Sort Order"</font> = <font color="purple">Table.AddColumn</font>( #<font color="red">"Ano Mes Sort Order"</font>, <font color="red">"DataSerial"</font>, each [Year] * 10000 + [Mês] * 100 + [Dia do Mês], <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Mes Abrev"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Ano Mes Dia Sort Order"</font>, <font color="red">"Month"</font>, each <font color="purple">Text.Start</font>([Nome do Mês], 3), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Datas Passadas"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Mes Abrev"</font>, "Passado?", each if [Calendario] &lt; <font color="purple">Date.From</font>(<font color="purple">DateTime.LocalNow</font>()) then 1 else 0, <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Mes Atual"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Datas Passadas"</font>, <font color="red">"Mês Ano Atual"</font>, each if [Mês] = <font color="purple">Date.Month</font>(<font color="purple">DateTime.LocalNow</font>()) and [Year] = <font color="purple">Date.Year</font>(<font color="purple">DateTime.LocalNow</font>()) then 1 else 0, <font color="purple">Int64.Type</font>),<br><br>    #"Ano Corrente?" = <font color="purple">Table.AddColumn</font>(#<font color="red">"Mes Atual"</font>,"Ano Atual?",each if [Year] = <font color="purple">Date.Year</font>(<font color="purple">DateTime.LocalNow</font>()) then 1 else 0,<font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Anos Forecast"</font> =  <font color="purple">Table.AddColumn</font>(#"Ano Corrente?<font color="red">" ,"</font>Anos Forecast?",each if [Year] &gt;= (<font color="purple">Date.Year</font>(<font color="purple">DateTime.LocalNow</font>()) - 1) then 1 else 0,<font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Somente Datas de Projecao"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Anos Forecast"</font>,each [Calendario] &lt;= #<font color="red">"Max Forecast Year"</font>)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Somente Datas de Projecao"</font></td></tr><tr><td>Measure-87ad71d7-3b2f-4e3a-b62a-7b1ddb250eb6</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text(<font color="red">"i45WMlKKjQUA"</font>, <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [Medidas = _t]),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(Source,{{<font color="red">"Medidas"</font>, <font color="purple">Int64.Type</font>}}),<br><br>    #<font color="red">"Removed Columns"</font> = <font color="purple">Table.RemoveColumns</font>(#<font color="red">"Changed Type"</font>,{<font color="red">"Medidas"</font>})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Removed Columns"</font></td></tr><tr><td>dim Regions-4452adad-68a8-4844-94f8-37b8aa33160c</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"Aux Distributed Energy"</font>,<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(Source,{<font color="red">"SigUF"</font>, <font color="red">"NomRegiao"</font>, <font color="red">"CodMunicipioIbge"</font>, <font color="red">"NomMunicipio"</font>}),<br><br>    #<font color="red">"Removed Duplicates"</font> = <font color="purple">Table.Distinct</font>(#<font color="red">"Removed Other Columns"</font>, {<font color="red">"CodMunicipioIbge"</font>}),<br><br>    #<font color="red">"Filtered Rows"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Removed Duplicates"</font>, each ([SigUF] &lt;&gt; <font color="red">""</font>)),<br><br>    #<font color="red">"Replaced Value"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Filtered Rows"</font>,<font color="red">"Norte"</font>,<font color="red">"North"</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"NomRegiao"</font>}),<br><br>    #<font color="red">"Replaced Value1"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Replaced Value"</font>,<font color="red">"Nordeste"</font>,<font color="red">"North East"</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"NomRegiao"</font>}),<br><br>    #<font color="red">"Replaced Value2"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Replaced Value1"</font>,<font color="red">"Sudeste"</font>,<font color="red">"South East"</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"NomRegiao"</font>}),<br><br>    #<font color="red">"Replaced Value3"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Replaced Value2"</font>,<font color="red">"Sul"</font>,<font color="red">"South"</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"NomRegiao"</font>}),<br><br>    #<font color="red">"Replaced Value4"</font> = <font color="purple">Table.ReplaceValue</font>(#<font color="red">"Replaced Value3"</font>,<font color="red">"Centro Oeste"</font>,<font color="red">"Mid West"</font>,<font color="purple">Replacer.ReplaceText</font>,{<font color="red">"NomRegiao"</font>})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Replaced Value4"</font></td></tr><tr><td>dim Source Type-fb4d6cac-c39a-4d85-89be-9134fb4977a1</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"Aux Utility Energy"</font>,<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(Source,{<font color="red">"SigTipoGeracao"</font>}),<br><br>    #<font color="red">"Removed Duplicates"</font> = <font color="purple">Table.Distinct</font>(#<font color="red">"Removed Other Columns"</font>),<br><br>    #<font color="red">"Added Custom"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Removed Duplicates"</font>, <font color="red">"Fonte"</font>, each if [SigTipoGeracao] = <font color="red">"UFV"</font> then <font color="red">"Solar"</font> else if [SigTipoGeracao] = <font color="red">"UTE"</font> then <font color="red">"Therme Electric"</font> else if [SigTipoGeracao] = <font color="red">"EOL"</font> then <font color="red">"Wind"</font> else if [SigTipoGeracao] = <font color="red">"CGH"</font> then <font color="red">"Hydro"</font> else if [SigTipoGeracao] = <font color="red">"UTN"</font> then <font color="red">"Nuclear"</font> else if [SigTipoGeracao] = <font color="red">"UHE"</font> then <font color="red">"Hydro"</font> else if [SigTipoGeracao] = <font color="red">"PCH"</font> then <font color="red">"Hydro"</font> else <font color="red">"Not Defined"</font>, <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Added Custom1"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Added Custom"</font>, <font color="red">"Matriz da Fonte"</font>, each if <font color="purple">List.Contains</font>Any({[Fonte]},{<font color="red">"Hydro"</font>,<font color="red">"Wind"</font>,<font color="red">"Solar"</font>}) then <font color="red">"Renewable"</font> else if <font color="purple">List.Contains</font>Any({[Fonte]},{<font color="red">"Nuclear"</font>,<font color="red">"Therme Electric"</font>}) then <font color="red">"Non Renewable"</font> else <font color="red">"Not Defined"</font>,<font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Added Custom2"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Added Custom1"</font>, <font color="red">"Energy Type"</font>, each if [Fonte] = <font color="red">"Solar"</font> then <font color="red">"Solar"</font> else <font color="red">"Other Sources"</font>,<font color="blue">type</font> <font color="blue">text</font>)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Added Custom2"</font></td></tr><tr><td>fact Utility Energy-36f9c05d-76fd-4587-9750-9f4ed950e806</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"Aux Utility Energy"</font>,<br><br>    Custom1 = <font color="purple">Table.AddColumn</font>(Source, <font color="red">"Tipo Geracao"</font>, each <font color="red">"Utility"</font>,<font color="blue">type</font> <font color="blue">text</font>)<br><br><font color="blue">in</font><br><br>    Custom1</td></tr><tr><td>Partition</td><td></td></tr><tr><td>dim Segment-d734405f-8045-4aa0-8765-a565f82cd0cd</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"Aux Distributed Energy"</font>,<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(Source,{<font color="red">"CodClasseConsumo"</font>, <font color="red">"DscClasseConsumo"</font>}),<br><br>    #<font color="red">"Removed Duplicates"</font> = <font color="purple">Table.Distinct</font>(#<font color="red">"Removed Other Columns"</font>, {<font color="red">"CodClasseConsumo"</font>}),<br><br>    #<font color="red">"Added Custom"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Removed Duplicates"</font>, <font color="red">"Segment"</font>, each if [CodClasseConsumo] = 1 then <font color="red">"Residential"</font> else "C&amp;I",<font color="blue">type</font> <font color="blue">text</font>)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Added Custom"</font></td></tr><tr><td>fact Distributed Energy-e340813f-5587-42b8-b7e4-992c153e0091</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"Aux Distributed Energy"</font>,<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(Source,{<font color="red">"SigAgente"</font>, <font color="red">"CodClasseConsumo"</font>, <font color="red">"DscSubGrupoTarifario"</font>, <font color="red">"CodMunicipioIbge"</font>, <font color="red">"DthAtualizaCadastralEmpreend"</font>, <font color="red">"SigModalidadeEmpreendimento"</font>, <font color="red">"SigTipoGeracao"</font>, <font color="red">"DscPorte"</font>, <font color="red">"MdaPotenciaInstaladaKW"</font>}),<br><br>    #<font color="red">"Added Custom"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Removed Other Columns"</font>, <font color="red">"Tipo Geracao"</font>, each <font color="red">"Distributed"</font>,<font color="blue">type</font> <font color="blue">text</font>)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Added Custom"</font></td></tr><tr><td>dim Modality-149ee634-9745-47bd-b1b8-5c50987e289d</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"Aux Distributed Energy"</font>,<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(Source,{<font color="red">"SigModalidadeEmpreendimento"</font>}),<br><br>    #<font color="red">"Filtered Rows"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Removed Other Columns"</font>, each ([SigModalidadeEmpreendimento] &lt;&gt; <font color="red">" "</font>)),<br><br>    #<font color="red">"Removed Duplicates"</font> = <font color="purple">Table.Distinct</font>(#<font color="red">"Filtered Rows"</font>, {<font color="red">"SigModalidadeEmpreendimento"</font>}),<br><br>    Custom1 =  <font color="purple">Table.AddColumn</font>(#<font color="red">"Removed Duplicates"</font>, <font color="red">"Modality"</font>, each if [SigModalidadeEmpreendimento] = <font color="red">"P"</font> then <font color="red">"Micro/Mini"</font> else if [SigModalidadeEmpreendimento] = <font color="red">"R"</font> then <font color="red">"Self Consumption"</font> else if [SigModalidadeEmpreendimento] = <font color="red">"C"</font> then <font color="red">"Shared"</font> else if [SigModalidadeEmpreendimento] = <font color="red">"M"</font> then <font color="red">"Multiples CU"</font> else <font color="red">"Not Defined"</font>, <font color="blue">type</font> <font color="blue">text</font>)<br><br><font color="blue">in</font><br><br>    Custom1</td></tr><tr><td>dim Energy Type-c90bdb81-97e6-4bed-a617-c9ce7cdbf389</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i45WCi3JzMksqVSK1YlWcsksLinKTCotSU1Rio0FAA==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Tipo Geracao"</font> = _t]),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(Source,{{<font color="red">"Tipo Geracao"</font>, <font color="blue">type</font> <font color="blue">text</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Changed Type"</font></td></tr><tr><td>Partition</td><td></td></tr><tr><td>fact Fore_Brazil_Scenarios-4c4cb1db-b9ec-4c36-8fc5-2b6c74fa6579</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"SharePoint Folder Acess"</font>,<br>    <br>    #<font color="red">"Filtered Rows"</font> = <font color="purple">Table.SelectRows</font>(Source, each ([Name] = <font color="red">"Br_Avg"</font> or [Name] = <font color="red">"Br_Opt"</font> or [Name] = <font color="red">"Br_Pess"</font>)),<br><br>    #<font color="red">"Added Custom"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Filtered Rows"</font>, <font color="red">"Scenario"</font>, each if [Name] = <font color="red">"Br_Pess"</font> then <font color="red">"Pessimistic"</font> else if [Name] = <font color="red">"Br_Opt"</font> then <font color="red">"Optimistic"</font> else <font color="red">"Average"</font>,<font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Invoked Custom Function"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Added Custom"</font>, <font color="red">"Convert Brazil Scenario"</font>, each #<font color="red">"Brazil Scenarios"</font>([Name])),<br><br>    #<font color="red">"Expanded Convert Brazil Scenario"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Invoked Custom Function"</font>, <font color="red">"Convert Brazil Scenario"</font>, {<font color="red">"Type"</font>, <font color="red">"Date"</font>, <font color="red">"Value"</font>}, {<font color="red">"Type"</font>, <font color="red">"Date"</font>, <font color="red">"Value"</font>}),<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Expanded Convert Brazil Scenario"</font>,{<font color="red">"Scenario"</font>, <font color="red">"Type"</font>, <font color="red">"Date"</font>, <font color="red">"Value"</font>}),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Removed Other Columns"</font>,{{<font color="red">"Type"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Date"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"Value"</font>, <font color="blue">type</font> number}}),<br><br>    #<font color="red">"Filter CY"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Changed Type"</font>, each <font color="purple">Date.Year</font>([Date]) &gt;= <font color="purple">Date.Year</font>(<font color="purple">Date.From</font>(<font color="purple">DateTime.LocalNow</font>()))-1)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Filter CY"</font></td></tr><tr><td>Max Forecast Year-cd1ef2ea-4b1f-4dcb-88bb-392c8d93c692</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">List.Max</font>(#<font color="red">"fact Fore_Brazil_Scenarios"</font>[Date])<br><br><font color="blue">in</font><br><br>    Source</td></tr><tr><td>Aux (Actual vs Forecast)-9a948850-a691-4b85-ab41-03342f99461c</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text(<font color="red">"i45WckwuKU3MUYrViVZyyy9KTU4sLlGKjQUA"</font>, <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [Type = _t]),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(Source,{{<font color="red">"Type"</font>, <font color="blue">type</font> <font color="blue">text</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Changed Type"</font></td></tr><tr><td>fact Fore_Other_Countries-af88a62f-3b22-4690-b531-349a0f696a4d</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"SharePoint Folder Acess"</font>,<br>    <br>    #<font color="red">"Filtered Rows"</font> = <font color="purple">Table.SelectRows</font>(Source, each ([Name] = <font color="red">"Chile"</font> or [Name] = <font color="red">"Colombia"</font> or [Name] = <font color="red">"Mexico"</font>)),<br><br>    #<font color="red">"Invoked Custom Function"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Filtered Rows"</font>, <font color="red">"Forecast Other Countries"</font>, each #<font color="red">"Forecast Other Countries"</font>([Name])),<br><br>    #<font color="red">"Expanded Forecast Other Countries"</font> = <font color="purple">Table.ExpandTableColumn</font>(#<font color="red">"Invoked Custom Function"</font>, <font color="red">"Forecast Other Countries"</font>, {<font color="red">"Type"</font>, <font color="red">"Date"</font>, <font color="red">"Value"</font>}, {<font color="red">"Type"</font>, <font color="red">"Date"</font>, <font color="red">"Value"</font>}),<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Expanded Forecast Other Countries"</font>,{<font color="red">"Name"</font>, <font color="red">"Type"</font>, <font color="red">"Date"</font>, <font color="red">"Value"</font>}),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Removed Other Columns"</font>,{{<font color="red">"Type"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Date"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"Value"</font>, <font color="purple">Int64.Type</font>}}),<br><br>    #<font color="red">"Filter CY"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Changed Type"</font>, each <font color="purple">Date.Year</font>([Date]) &gt;= <font color="purple">Date.Year</font>(<font color="purple">Date.From</font>(<font color="purple">DateTime.LocalNow</font>()))-1)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Filter CY"</font></td></tr><tr><td>dim Countries_Flag-f5b3406a-bf40-4702-829e-4fcfa6e89ed2</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">Web.BrowserContents</font>(<font color="red">"https:<font color="green">//www.geonames.org/countries/"</font>),</font><br><br>    #<font color="red">"Extracted Table From Html"</font> = <font color="purple">Html.Table</font>(Source, {{<font color="red">"Column1"</font>, "TABLE[id='countries'] &gt; * &gt; TR &gt; :nth-child(1)"}, {<font color="red">"Column2"</font>, "TABLE[id='countries'] &gt; * &gt; TR &gt; :nth-child(2)"}, {<font color="red">"Column3"</font>, "TABLE[id='countries'] &gt; * &gt; TR &gt; :nth-child(3)"}, {<font color="red">"Column4"</font>, "TABLE[id='countries'] &gt; * &gt; TR &gt; :nth-child(4)"}, {<font color="red">"Column5"</font>, "TABLE[id='countries'] &gt; * &gt; TR &gt; :nth-child(5)"}, {<font color="red">"Column6"</font>, "TABLE[id='countries'] &gt; * &gt; TR &gt; :nth-child(6)"}, {<font color="red">"Column7"</font>, "TABLE[id='countries'] &gt; * &gt; TR &gt; :nth-child(7)"}, {<font color="red">"Column8"</font>, "TABLE[id='countries'] &gt; * &gt; TR &gt; :nth-child(8)"}, {<font color="red">"Column9"</font>, "TABLE[id='countries'] &gt; * &gt; TR &gt; :nth-child(9)"}}, [RowSelector="TABLE[id='countries'] &gt; * &gt; TR"]),<br><br>    #<font color="red">"Promoted Headers"</font> = <font color="purple">Table.PromoteHeaders</font>(#<font color="red">"Extracted Table From Html"</font>, [PromoteAllScalars=<font color="blue">true</font>]),<br><br>    #<font color="red">"Removed Other Columns"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Promoted Headers"</font>,{"ISO-3166alpha2<font color="red">", "</font>Country"}),<br><br>    #<font color="red">"Lowercased Text"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Removed Other Columns"</font>,{{"ISO-3166alpha2", <font color="purple">Text.Lower</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Added Custom"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Lowercased Text"</font>, <font color="red">"URL Flag"</font>, each <font color="red">"https:<font color="green">//img.geonames.org/flags/x/"</font>&amp;[#"ISO-3166alpha2"]&amp;<font color="red">".gif"</font>,<font color="blue">type</font> <font color="blue">text</font>),</font><br><br>    #<font color="red">"Merged Queries"</font> = <font color="purple">Table.NestedJoin</font>(#<font color="red">"Added Custom"</font>, {<font color="red">"Country"</font>}, #<font color="red">"fact Fore_Other_Countries"</font>, {<font color="red">"Name"</font>}, <font color="red">"fact Fore_Other_Countries"</font>, <font color="purple">JoinKind.Inner</font>),<br><br>    #<font color="red">"Removed Other Columns1"</font> = <font color="purple">Table.SelectColumns</font>(#<font color="red">"Merged Queries"</font>,{<font color="red">"Country"</font>, <font color="red">"URL Flag"</font>})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Removed Other Columns1"</font></td></tr><tr><td>dim Description-9015f821-9930-40ff-925c-4a37a416ed30</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"SharePoint Folder Acess"</font>,<br>    <br>    Description_Table = Source{[Item=<font color="red">"Description"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(Description_Table,{{<font color="red">"Country"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Energy Type"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Description"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Trimmed Text"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Changed Type"</font>,{{<font color="red">"Energy Type"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Description"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Country"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Trimmed Text"</font></td></tr><tr><td>fact Fore_Latam-26b620a8-6631-4fd0-8b3b-42e9314cbcbd</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"SharePoint Folder Acess"</font>,<br>    <br>    Latam_Outlook_Table = Source{[Item=<font color="red">"Latam"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br><br>    #<font color="red">"Unpivoted Other Columns"</font> = <font color="purple">Table.Unpivot</font>OtherColumns(Latam_Outlook_Table, {<font color="red">"Type"</font>}, <font color="red">"Date"</font>, <font color="red">"Value"</font>),<br><br>    #<font color="red">"Trimmed Text"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Unpivoted Other Columns"</font>,{{<font color="red">"Type"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Date"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Trimmed Text"</font>,{{<font color="red">"Type"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Date"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"Value"</font>, <font color="blue">type</font> number}}),<br><br>    #<font color="red">"Filtered Rows"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Changed Type"</font> ,each [Date] &lt;= #<font color="red">"Max Forecast Year"</font> and <font color="purple">Date.Year</font>([Date]) &gt;= <font color="purple">Date.Year</font>(<font color="purple">Date.From</font>(<font color="purple">DateTime.LocalNow</font>()))-1)<br><br><font color="blue">in</font><br><br>    #<font color="red">"Filtered Rows"</font></td></tr><tr><td>fact Fore_Latam_Outlook-7617d44f-359f-4b24-8a6d-25ac0dcc62b2</td><td><font color="blue">let</font><br><br>    Source = #<font color="red">"SharePoint Folder Acess"</font>,    <br><br>    Latam_Outlook_Table = Source{[Item=<font color="red">"Latam_Outlook"</font>,Kind=<font color="red">"Table"</font>]}[Data],<br><br>    #<font color="red">"Unpivoted Other Columns"</font> = <font color="purple">Table.Unpivot</font>OtherColumns(Latam_Outlook_Table, {<font color="red">"Type"</font>}, <font color="red">"Date"</font>, <font color="red">"Value"</font>),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Unpivoted Other Columns"</font>,{{<font color="red">"Type"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Date"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"Value"</font>, <font color="blue">type</font> number}}),<br><br>    #<font color="red">"Filter_Rows"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Changed Type"</font> ,each [Date] &lt;= #<font color="red">"Max Forecast Year"</font> and <font color="purple">Date.Year</font>([Date]) &gt;= <font color="purple">Date.Year</font>(<font color="purple">Date.From</font>(<font color="purple">DateTime.LocalNow</font>()))-1)<br><br><font color="blue">in</font><br><br>   #<font color="red">"Filter_Rows"</font></td></tr><tr><td>Scenarios Sync Filters-b8c7784e-98a8-4c49-a986-2a9e5a396a96</td><td><font color="blue">let</font><br><br>    Source = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text(<font color="red">"i45W8i8oyczNLC7JTFbSUTJUitWJVnIsSy1KTE8F8o3A/IDU4mKEGmOl2FgA"</font>, <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [Scenarios = _t, #<font color="red">"Sort Order"</font> = _t]),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(Source,{{<font color="red">"Scenarios"</font>, <font color="blue">type</font> <font color="blue">text</font>}, {<font color="red">"Sort Order"</font>, <font color="purple">Int64.Type</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Changed Type"</font></td></tr></tbody></table>
      <script>
         var toggler = document.getElementsByClassName("caret");
         for (var i = 0; i < toggler.length; i++){
         	toggler[i].addEventListener("click", function() {
         		this.parentElement.querySelector(".nested").classList.toggle("active");
         	});
         }
         	
         var togglerAll = document.getElementsByClassName("dropDownCaret");
         for (var j=0; j<togglerAll.length; j++){
         	togglerAll[j].addEventListener("click", function(event){
         		if (event.currentTarget != event.target) return;
         		if(this.parentElement.querySelector(".nested").classList.contains("active")){
         			this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
         				if(currentValue.classList.contains("active")){
         					currentValue.classList.remove("active");
         				}
         			});
         		}
         		else{
         			this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
         				if(!currentValue.classList.contains("active")){
         					currentValue.classList.add("active");
         				}
         			});
         		}
         	});
         }
      </script>
   
</body></html>